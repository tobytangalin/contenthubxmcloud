<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta http-equiv="x-ua-compatible" content="IE=edge"></meta><meta name="format-detection" content="telephone=no"></meta><meta name="viewport" content="width=device-width, initial-scale=1"></meta><meta name="search" content="default"></meta><meta name="use.ic" content="no"></meta><meta name="Audience - do not use" content=""></meta><meta name="clubot" content=""></meta><meta name="data model" content=""></meta><meta name="DxP type - Do Not Use" content=""></meta><meta name="media_icon" content=""></meta><meta name="product" content="XM Cloud"></meta><meta name="Publishing target" content="Production"></meta><meta name="Ready for publishing - do not use" content=""></meta><meta name="role" content="developers"></meta><meta name="topic_tripane" content=""></meta><meta name="version" content=""></meta><meta name="tocstandalone" content="yes"></meta><meta name="theme" content="1"></meta><meta name="search.placeholder" content="Search"></meta><meta name="search.results" content="Search results"></meta><meta name="no.search.results" content="No results found"></meta><script type="text/javascript">
var theme = '1';

			
			window.versionsfile = '';


			window.indexDict = new Array();
			window.store = {};
			window.portalLanguage = 'en';
			window.enterKey = 'select';
			
			
				var fuse_threshold = 0.3;
			
					var local_csh = false;
				
					var anchoroption = true;
				var instantsearch_minlength = 1;
						
			var useanchorlinks = false;
			
					function addSearch(){
					//not used with custom or elastic search
					}
				</script><title>The Next.js Multisite add-on</title><link rel="stylesheet" type="text/css" href="../css/docbook.css"></link><link rel="stylesheet" type="text/css" href="../css/font-awesome.css"></link><link rel="stylesheet" type="text/css" href="../css/roboto.font.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1.css?version=20230630"></link><link rel="stylesheet" type="text/css" href="../css/theme1-colors.css?version=20230630"></link><link rel="stylesheet" type="text/css" href="../css/content-theme1.css?version=20230630"></link><link rel="stylesheet" type="text/css" href="../css/sm-core-css.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-simple.css"></link><link rel="stylesheet" type="text/css" href="../css/style-print.css"></link><link rel="stylesheet" type="text/css" href="../css/style-common.css"></link><link rel="stylesheet" type="text/css" href="../css/style-modern-tables.css"></link><link rel="stylesheet" type="text/css" href="../css/graphical-lists.css"></link><link rel="stylesheet" type="text/css" href="/css/sitecore-custom-default-xmc.css?version=20230630"></link><script src="../js/jquery-3/jquery-3.4.1.min.js" type="text/javascript"></script><script src="../js/jquery-migrate-3.0.1.min.js" type="text/javascript"></script><script src="../js/materialize.min.js" type="text/javascript"></script><script src="../js/bootstrap.min.js" type="text/javascript"></script><script src="../js/purl.js" type="text/javascript"></script><script src="../js/jquery.smartmenus.js" type="text/javascript"></script><script src="js/toc.js?version=20230630" type="text/javascript"></script><script src="../js/create-toc.js" type="text/javascript"></script><script src="../js/html5-2-mp-common.js?version=20230630" type="text/javascript"></script><script src="../js/html5-2.js?version=20230630" type="text/javascript"></script><script src="../js/checklist.js" type="text/javascript"></script><script src="../js/clipboard.min.js" type="text/javascript"></script><script src="../js/csh.js" type="text/javascript"></script><script src="/js/layout-custom-script.js" type="text/javascript"></script><meta xmlns:xhtml="http://www.w3.org/1999/xhtml" name="generator" content="Paligo"></meta><meta name="description" content="The Next.js Multisite add-on includes an example setup for hosting multiple sites from a single Next.js application."></meta><link rel="prev" href="troubleshooting-the-next-js-personalize-add-on.html#UUID-e0329d34-e74a-dbdf-6340-1a7216872ab5_section-idm4627197125499233299673006775" title="Troubleshoot Page View events"></link><link rel="next" href="the-next-js-multisite-add-on.html#UUID-be76d43e-8a3a-019c-3715-81682495783a_section-idm1402585725504806" title="Architecture"></link><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" async="async"></script><link rel="icon" href="/favicon.ico" type="image/x-icon"></link><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cookieconsent/3.1.1/cookieconsent.min.css"></link><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/cookieconsent/3.1.1/cookieconsent.min.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/3.0.1/js.cookie.min.js"></script><script type="text/javascript">var privacypolicy = 'https://www.sitecore.com/trust/privacy-policy';
var consenttype = 'opt-out';
</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-72664331-1"></script><script type="text/javascript">const measurementId = 'UA-72664331-1';

						$(document).on('cookies.consented', () => {
							window.dataLayer = window.dataLayer || [];
							function gtag(){dataLayer.push(arguments)};

							gtag('js', new Date());
							gtag('config', measurementId);
						});
					</script><script type="text/javascript" src="../js/cookie-consent.js"></script><script type="text/javascript">
				$(document).ready(function () {
				$(".mediaobject img").addClass('materialboxed');
				//Exclude images with links
				$(".mediaobject a img").removeClass('materialboxed');
				if (!document.documentMode) {
				$('.materialboxed').materialbox();
				}});
			</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/styles/googlecode.min.css"></link><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/highlight.min.js"></script><script type="text/javascript">
			$(document).ready(function() {

				$('pre:not(.embedcode)').each(function() {
					/**
					 * @type {string}
					 */
					var language = $(this).data('language');

					if (language === 'plaintext' || language === 'text') {
						$(this).addClass(language).addClass('hljs');
						return true;
					}
					else {
						var clone = this.cloneNode(true);
						hljs.highlightBlock(clone);
						$(this).empty().append($(clone).contents());
						$(this).attr("class", $(clone).attr("class"));
					}
				});
			});
			</script><link href="//customer.cludo.com/assets/2063/10039/cludo-search.min.css" type="text/css" rel="stylesheet"></link></head><body class="theme1 colored-top page-toc current-toc-section-focus" data-spy="scroll" data-target=".section-nav-container" data-offset="100" data-link-prefix=""><style type="text/css">
            div.skipnav {
            }
            div.skipnav a {
                position: fixed;
                left: -10000px;
                top: 1.5em;
                width: 1px;
                height: 1px;
                overflow: hidden;
            }
            div.skipnav a:focus, div.skipnav a:active, div.skipnav a:hover {
                background: white;
                color: black;
                box-shadow: 5px 5px 5px 0px rgba(0,0,0,0.5);
                position: fixed;
                left: 2em;
                top: 1.5em;
                width: auto;
                height: auto;
                overflow: visible;
                text-decoration: underline;
                z-index: 99999; /* has to be higher than the side panel */
    }
          </style><div class="skipnav"><a href="#content-wrapper">Skip to main content</a></div><header class="site-header"><nav class="site-header-navbar navbar navbar-fixed-top"><div class="navbar-container"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><div id="logotype-container" class="pull-left"><a class="navbar-brand" href="https://doc.sitecore.com/xmc/" target="_blank" rel="noopener"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div></div><div class="navbar-collapse collapse" id="navbar"></div></div></nav></header><div class="site-body"><div class="site-body-container"><div class="site-body-row"><aside xmlns:xinfo="http://ns.expertinfo.se/cms/xmlns/1.0" class="site-sidebar"><div class="site-sidebar-header"><a href="https://doc.sitecore.com/xmc/" target="_blank"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div><form id="search-form" class="site-sidebar-search" autocomplete="off"><input type="text" class="form-control search-field" placeholder="Search" id="aa-search-input"></input></form><div id="toc-standalone-placeholder"></div></aside><div class="site-content"><div class="toolbar"><div class="toolbar-tools"><div id="navbar" class="navbar-collapse collapse"></div><div class="tool-print"><i class="fa fa-print" aria-hidden="true">print</i></div><div class="tool-search"><i class="fa fa-search" aria-hidden="true"></i></div><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button></div><div class="breadcrumb-container"><ul class="breadcrumb"><li class="breadcrumb-link"><a href="index-en.html">XM Cloud Documentation for Developers</a></li><li class="breadcrumb-link"><a href="sitecore-javascript-rendering-sdks--jss-.html">Sitecore JavaScript Rendering SDKs (JSS)</a></li><li class="breadcrumb-link"><a href="sitecore-javascript-rendering-sdk--jss--for-next-js.html">Sitecore JavaScript Rendering SDK (JSS) for Next.js</a></li><li class="breadcrumb-link"><a href="add-ons-for-next-js-applications.html">Add-ons for Next.js applications</a></li><li class="breadcrumb-node">The Next.js Multisite add-on</li></ul></div></div><main><div id="top-pager"><ul class="pager"><li class="previous"><a accesskey="p" class="prev pull-left prev visible-lg visible-md" id="header-navigation-prev" href="troubleshooting-the-next-js-personalize-add-on.html#UUID-e0329d34-e74a-dbdf-6340-1a7216872ab5_section-idm4627197125499233299673006775">Prev</a></li><li class="next"><a accesskey="n" class="pull-right next visible-lg visible-md" id="header-navigation-next" href="the-next-js-multisite-add-on.html#UUID-be76d43e-8a3a-019c-3715-81682495783a_section-idm1402585725504806">Next</a></li></ul></div><article class="topic content-container" id="content-wrapper"><div id="topic-content" class="topic-content"><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-d3272aa5-72d3-0635-844e-c64801575bb2" data-permalink="the-next-js-multisite-add-on.html" data-topic-level="1" data-relative-prefix="" data-time-modified="06/26/2023" data-publication-date="06/30/23" id="UUID-be76d43e-8a3a-019c-3715-81682495783a"><div class="titlepage"><div><div class="title"><h1 class="title" style="clear: both">The Next.js Multisite add-on</h1></div><div><div class="abstract"><div class="abstract-title">Abstract</div><p>The Next.js Multisite add-on includes an example setup for hosting multiple sites from a single Next.js application.</p></div></div></div></div><p></p><p></p><p>The Next.js Multisite add-on includes an example setup for hosting multiple sites from a single Next.js application. It uses <span class="underline"><a class="link" href="https://nextjs.org/docs/advanced-features/middleware" target="_blank" rel="noopener">Next.js Middleware</a></span> to serve the correct Sitecore site based on the incoming hostname.</p><p>You add this add-on using the <a class="link linktype-component" href="the-jss-app-initializer.html" title="The JSS app initializer">JSS initializer</a>. An XM Cloud project based on a Starter Kit automatically includes this add-on.</p><p>This add-on includes the following:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>A build-time JSS config plugin for multisite that fetches site information from Sitecore.</p></li><li class="listitem"><p>A Site Resolver plugin for multisite.</p></li><li class="listitem"><p>A <a class="link" href="https://nextjs.org/docs/advanced-features/middleware" target="_blank" rel="noopener">Next.js Middleware</a> plugin for multisite that rewrites to the correct site based on hostname.</p></li><li class="listitem"><p>A Page Props Factory plugin for multisite that sets the <code class="code">site</code> prop based on the rewrite path.</p></li></ul></div><section dir="ltr" class="section" data-origin-id="" data-publication-date="06/30/23" id="UUID-be76d43e-8a3a-019c-3715-81682495783a_section-idm1402585725504806"><div class="titlepage"><div><div class="title"><h2 class="title" style="clear: both">Architecture</h2></div></div></div><p>The following diagram shows the general flow when using the Next.js multisite add-on:</p><div class="mediaobject"><img src="image/uuid-8601bf89-50ab-5913-42ed-4773b05ab2c3.png" style="" alt="Diagram showing the build-time and run-time processes for a JSS Next.js multisite app."></img></div><p>The application fetches site information from Sitecore Experience Edge during the build process using a JSS <code class="code">config</code> plugin. The site information includes each configured site's name, hostname, default language, and other site properties.</p><div dir="ltr" class="note"><h3 class="title">Note</h3><p>If you configure <a class="link linktype-component" href="routing-and-page-composition-in-jss-next-js-apps.html#UUID-66872155-7eb3-4e31-91e9-5c000275631f_UUID-a0d91ffb-83c0-223f-b0c8-b4773d2e1bc7" title="Internationalized routing in JSS Next.js apps">internationalized routing</a> in your application, the route determines the current language, and your site's default language is the fallback language. If you don't use internationalized routing, the application uses the site's default language.</p></div><p>When a visitor requests a page, the <code class="code">MultisiteMiddleware</code> uses that site information ( <code class="code">SiteResolver.getByHost</code>) to determine the site based on the requested hostname and then rewrites to the site rewrite path. The Next.js app parses the site rewrite path to get the correct site information. It then uses this site for fetching layout data, dictionary data, and so on.</p><div dir="ltr" class="note"><h3 class="title">Note</h3><p>The application fetches site information at build-time and not at runtime for performance reasons. <span class="emphasis"><em>Every request</em></span> invokes <span class="emphasis"><em>all Next.js middleware</em></span>. Because new site additions are infrequent, fetching site information at runtime (while technically possible) is not the best solution due to the potential impact on performance for the visitor. You can automate this process <a class="link linktype-component" data-olink="true" href="/xp/en/developers/hd/21/sitecore-headless-development/en/walkthrough--deploying-jss-next-js-apps-to-vercel.html">using a webhook to trigger automatic redeployments of your Next.js app on publish</a>.</p></div></section><section dir="ltr" class="section" data-origin-id="" data-publication-date="06/30/23" id="UUID-be76d43e-8a3a-019c-3715-81682495783a_section-idm1403006226426923"><div class="titlepage"><div><div class="title"><h2 class="title" style="clear: both">Understanding the site rewrite path</h2></div></div></div><p>The Multisite add-on uses a rewrite path to identify the site.</p><p>This site rewrite path is:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Set by Multisite Middleware to the resolved site.</p></li><li class="listitem"><p>Read by the Next.js app for fetching layout data, dictionary data, and so on.</p></li><li class="listitem"><p>Used to enable static generation of multiple sites.</p></li></ul></div><p>The Next.js SDK and Next.js Multisite add-on encapsulate this logic, so you don't have to manipulate this path directly. However, understanding it can assist you when troubleshooting or making customizations.</p><p>The structure of the site rewrite path is as follows:</p><pre class="programlisting plaintext" data-language="plaintext" id="UUID-be76d43e-8a3a-019c-3715-81682495783a_programlisting-idm4534974713294433551531361142">
      /_site_&lt;site_name&gt;/&lt;path&gt;</pre><p>For example, the rewrite path for the <code class="code">/about</code> page for the <code class="code">foo</code> site is <code class="code">/_site_foo/about</code>.</p><div dir="ltr" class="note"><h3 class="title">Note</h3><p>If you implemented a specific page, such as <code class="code">about.tsx</code>, while also using the catch-all route, you must exclude the page route ( <code class="code">/about</code>) from the middleware execution to prevent it from triggering the catch-all route. You can exclude the route from middleware execution by modifying the matcher rules in the <code class="code">src/middleware.ts</code> file or updating the return value of the <code class="code">excludeRoute</code> function in the <code class="code">src\lib\middleware\plugins\multisite.ts</code> file.</p></div></section><section dir="ltr" class="section" data-origin-id="" data-publication-date="06/30/23" id="UUID-be76d43e-8a3a-019c-3715-81682495783a_section-idm4631468383044833551516396218"><div class="titlepage"><div><div class="title"><h2 class="title" style="clear: both">APIs</h2></div></div></div><p>The Next.js Multisite add-on uses the following APIs:</p><h3 id="idm45599227583504" class="bridgehead"><code class="code">GraphQLSiteInfoService</code></h3><p>The <code class="code">GraphQLSiteInfoService</code> fetches a list of configured site information (<code class="code">SiteInfo</code>) from Sitecore using your GraphQL Edge endpoint. The site information includes the site name, hostname, and default language.</p><p>You configure site information using <a class="link linktype-component" href="the-sxa-site-definition-fields.html" title="The SXA site definition fields">SXA site definition fields</a>.</p><div dir="ltr" class="important"><h3 class="title">Important</h3><p>The service fetches only SXA-based sites and includes no config-based site definitions.</p></div><p>The Next.js Multisite add-on provides a JSS config plugin in the <code class="code">/scripts/config/plugins/multisite.ts</code> file that uses the <code class="code">GraphQLSiteInfoService</code> to retrieve site information and then stores them in the generated <code class="code">src/temp/config</code> file in the <code class="code">sites</code> property.</p><h3 id="UUID-be76d43e-8a3a-019c-3715-81682495783a_bridgehead-idm1403359805757226" class="bridgehead"><code class="code">SiteResolver</code></h3><p>The <code class="code">SiteResolver</code> class resolves a site for a hostname or a site name based on the provided site information list (<code class="code">SiteInfo</code>).</p><div dir="ltr" class="note"><h3 class="title">Note</h3><p>To resolve a site by its hostname, the <code class="code">SiteResolver</code> class uses the <code class="code">getByHost</code> method. This method accepts a string containing one or more hostnames separated by <code class="code">|</code>, <code class="code">,</code>, or <code class="code">;</code>). It also accepts wildcards (<code class="code">*</code>).</p><p>The <code class="code">getByHost</code> method prioritizes specific hostnames over generic/wildcard hostnames:</p><pre class="programlisting plaintext" data-language="plaintext" id="UUID-be76d43e-8a3a-019c-3715-81682495783a_programlisting-idm4585461317785633553288848337">“order.eu.site.com” → “*.eu.site.com” → "*.site.com” → “*”</pre><p>If there are multiple sites with the same hostname defined, the method prioritizes the first found.</p></div><p>The list of site information is collected using <code class="code">SiteResolver</code> plugins and then provided to a singleton implementation in your application. The app uses the singleton implementation, defined by default in the <code class="code">/src/lib/site-resolver/index.ts</code> file, whenever it requires a site lookup, for example, for lookups by name in the Page Props Factory or by hostname in <code class="code">MultisiteMiddleware</code>.</p><p>There are two <code class="code">SiteResolver</code> plugins involved in the site collection process:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>The <code class="code">DefaultPlugin</code>, defined in the <code class="code">/src/lib/site-resolver/plugins/default.ts</code> file and provided by the base <code class="code">nextjs</code> template, loads the <span class="emphasis"><em>configured site</em></span> from <code class="code">config.jssAppName</code> and <code class="code">config.defaultLanguage</code> using a wildcard <code class="code">*</code> hostname. By default, the values of <code class="code">config.jssAppName</code> and <code class="code">config.defaultLanguage</code> come from:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><code class="code">config.jssAppName</code> - from the <code class="code">JSS_APP_NAME</code> environment variable, if set. Otherwise, from the <code class="code">config.appName</code> property in your <code class="code">package.json</code> file.</p></li><li class="listitem" id="UUID-be76d43e-8a3a-019c-3715-81682495783a_listitem-idm1403355156068138"><p><code class="code">config.defaultLanguage</code> - from the <code class="code">DEFAULT_LANGUAGE</code> environment variable, if set. Otherwise, from the <code class="code">config.language</code> property in your <code class="code">package.json</code> file.</p></li></ul></div></li><li class="listitem"><p>The <code class="code">MultisitePlugin</code>, defined in the <code class="code">/src/lib/site-resolver/plugins/multisite.ts</code> file and provided by the Next.js Multisite add-on, loads the sites fetched at build-time based on the <code class="code">config.sites</code> list <span class="emphasis"><em>after the configured</em></span> site.</p></li></ul></div><p>Adding the configured site first ensures it has higher priority than fetched sites with wildcard hostnames. This is helpful during your application's development stage when you have not set up hosting yet, and multiple sites are using a wildcard. <span class="emphasis"><em>After you configure more specific hostnames, those will be preferred instead.</em></span></p><h3 id="idm45599227496720" class="bridgehead"><code class="code">MultisiteMiddleware</code></h3><p>The <code class="code">MultisiteMiddleware</code><a class="link" href="https://nextjs.org/docs/advanced-features/middleware" target="_blank" rel="noopener">Next.js Middleware</a> handler rewrites to the appropriate Sitecore site based on a hostname. The middleware plugin uses the multisite middleware handler defined in the <code class="code">/src/lib/middleware/plugins/multisite.ts</code> file.</p><p>The <code class="code">MultisiteMiddleware</code> middleware handler:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Resolves sites with the <code class="code">SiteResolver</code> based on the requested host header.</p></li><li class="listitem"><p>Sets the <code class="code">sc_site</code> cookie with the site name value and the <code class="code">x-sc-rewrite</code> header with the value of the rewritten path, which can be reused by following middleware.</p></li><li class="listitem"><p>Rewrites the response to the specific site using the site rewrite path.</p></li></ul></div><div dir="ltr" class="tip"><h3 class="title">Tip</h3><p>Suppose you do not have a dedicated domain for each site, such as Vercel <a class="link" href="https://vercel.com/docs/concepts/deployments/preview-deployments#preview-urls" target="_blank" rel="noopener">Preview URLs</a>. In that case, you can force the application to use a specific site by specifying the <code class="code">sc_site</code> query string parameter—for example, <code class="code">https://foo.site.com?sc_site=bar</code>.</p><p>The <code class="code">sc_site</code> cookie will be used for subsequent requests while browsing the site, so you do not need to append this for every request. This behavior is configured by the <code class="code">useCookieResolution</code> option. Only <a class="link" href="https://vercel.com/docs/concepts/deployments/preview-deployments" target="_blank" rel="noopener">Vercel Preview Deployments</a> (where <code class="code">process.env.VERCEL_ENV === 'preview'</code>) enable the <code class="code">useCookieResolution</code> option by default.</p></div><h3 id="idm45599227486592" class="bridgehead"><code class="code">normalizeSiteRewrite</code></h3><p>The <code class="code">normalizeSiteRewrite</code> function removes site data from a site rewrite path (for example, so the application can appropriately retrieve layout data). It is used by the multisite path extraction plugin in the <code class="code">/src/lib/extract-path/plugins/multisite.ts</code> file.</p><h3 id="idm45599227484848" class="bridgehead"><code class="code">getSiteRewriteData</code></h3><p>The <code class="code">getSiteRewriteData</code> function extracts site data (<code class="code">site_name</code>) from <a class="link" href="the-next-js-multisite-add-on.html#UUID-be76d43e-8a3a-019c-3715-81682495783a_section-idm1403006226426923" title="Understanding the site rewrite path">a rewrite path</a>. It is utilized in the multisite Page Props Factory plugin in the <code class="code">/src/lib/page-props-factory/plugins/site.ts</code> file.</p><h3 id="idm45599227481824" class="bridgehead"><code class="code">MultisiteGraphQLSitemapService</code></h3><p>The <code class="code">MultisiteGraphQLSitemapService</code> is used to <a class="link linktype-component" href="preparing-the-list-of-pages-for-static-generation-or-export-in-jss-next-js-apps.html" title="Preparing the list of pages for static generation or export in JSS Next.js apps">fetch the list of pages for static generation for multiple sites</a>. </p></section><section dir="ltr" class="section" data-origin-id="" data-publication-date="06/30/23" id="UUID-be76d43e-8a3a-019c-3715-81682495783a_section-idm4631468322571233551517456946"><div class="titlepage"><div><div class="title"><h2 class="title" style="clear: both">Limitations</h2></div></div></div><p>The Next.js Multisite add-on has the following limitations:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Site information is fetched only at build-time. You must rebuild the application if a new site is added or the hostname is modified.</p></li><li class="listitem"><p>Config-based site definitions are not currently included. Only SXA-based sites will be fetched.</p></li><li class="listitem"><p>Next.js i18n <a class="link" href="https://nextjs.org/docs/advanced-features/i18n-routing#domain-routing" target="_blank" rel="noopener">domain routing</a> and automatic locale detection were not necessarily intended for multisite scenarios. For example, you cannot have multiple domains mapped to the same default locale. If you run into limitations, remember you can also serve sites using a dedicated rendering host (that is, a single site).</p></li></ul></div></section></section><div class="footer-content"><div class="glossary-definitions"></div></div><footer></footer></div></article><aside class="section-nav-container"><ul class="section-nav nav"><li><a href="#UUID-be76d43e-8a3a-019c-3715-81682495783a">The Next.js Multisite add-on</a></li><li><a href="#UUID-be76d43e-8a3a-019c-3715-81682495783a_section-idm1402585725504806">Architecture</a></li><li><a href="#UUID-be76d43e-8a3a-019c-3715-81682495783a_section-idm1403006226426923">Understanding the site rewrite path</a></li><li><a href="#UUID-be76d43e-8a3a-019c-3715-81682495783a_section-idm4631468383044833551516396218">APIs</a></li><li><a href="#UUID-be76d43e-8a3a-019c-3715-81682495783a_section-idm4631468322571233551517456946">Limitations</a></li></ul></aside></main><div id="bottom-pager"><ul class="pager"><li class="previous"><a accesskey="p" class="prev pull-left prev visible-lg visible-md" id="header-navigation-prev" href="troubleshooting-the-next-js-personalize-add-on.html#UUID-e0329d34-e74a-dbdf-6340-1a7216872ab5_section-idm4627197125499233299673006775">Prev</a></li><li class="next"><a accesskey="n" class="pull-right next visible-lg visible-md" id="header-navigation-next" href="the-next-js-multisite-add-on.html#UUID-be76d43e-8a3a-019c-3715-81682495783a_section-idm1402585725504806">Next</a></li></ul></div><footer class="site-footer"><div class="inner"><div class="copyright"> © 2023 Sitecore </div><div class="date-modified"><span class="date-modified-text">Last modified: </span><span class="formatted-date">06/26/2023</span></div><div class="publication-date"><span class="publication-date-text">Publication date</span><span class="pubdate-delimiter">: </span><span class="formatted-date">06/30/23</span></div></div></footer></div></div></div></div><script type="text/javascript" src="//customer.cludo.com/scripts/bundles/search-script.min.js"></script><script>
			var CludoSearch;
			(function () {
			var cludoSettings = {
			customerId: 2063,
			engineId: 12826,
			language: 'en',
			searchInputs: ["search-form","cludo-search-content-form","cludo-search-mobile-form"],
			hideSearchFilters: true,
			type: 'standardOverlay',
			facets: ["Category", "ProductVer", "Product", "Version"],
			useStandardSearchTemplate: false,
			customerTemplate: "OverlayCopy",
			searchApiUrl: 'https://api-eu1.cludo.com/api/v3'
			};
			CludoSearch= new Cludo(cludoSettings);
			CludoSearch.init();
			})();
		</script><!-- www.Cludo.com Search body init script start --></body></html>
